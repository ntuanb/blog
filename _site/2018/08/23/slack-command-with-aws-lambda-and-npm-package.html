<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Slack Command with AWS Lambda and NPM Package - Blog</title><link rel="stylesheet" href="/css/main.css"><meta name="google-site-verification" content="kfeeGYDzKTHFmlRAJa4qOLf69EM9w4yzLcgcfgdKMEM" /><title>Slack Command with AWS Lambda and NPM Package | Blog</title><meta name="generator" content="Jekyll v3.7.3" /><meta property="og:title" content="Slack Command with AWS Lambda and NPM Package" /><meta property="og:locale" content="en_US" /><meta name="description" content="Challenge: Implement a Slack app that flips tables and deploy it to AWS Lambda and NPM." /><meta property="og:description" content="Challenge: Implement a Slack app that flips tables and deploy it to AWS Lambda and NPM." /><link rel="canonical" href="https://blog.tuanb.me/2018/08/23/slack-command-with-aws-lambda-and-npm-package.html" /><meta property="og:url" content="https://blog.tuanb.me/2018/08/23/slack-command-with-aws-lambda-and-npm-package.html" /><meta property="og:site_name" content="Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-08-23T00:00:00+10:00" /><script type="application/ld+json"> {"description":"Challenge: Implement a Slack app that flips tables and deploy it to AWS Lambda and NPM.","@type":"BlogPosting","url":"https://blog.tuanb.me/2018/08/23/slack-command-with-aws-lambda-and-npm-package.html","headline":"Slack Command with AWS Lambda and NPM Package","dateModified":"2018-08-23T00:00:00+10:00","datePublished":"2018-08-23T00:00:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.tuanb.me/2018/08/23/slack-command-with-aws-lambda-and-npm-package.html"},"@context":"http://schema.org"}</script></head><body style="background-color: rgb(255, 255, 255)"><script async src="/js/theme.min.js"></script><header> <a href="/"><div class="home"></div></a></header><main> <article><h1 class="post-headline">Slack Command with AWS Lambda and NPM Package</h1><p class="meta"><small>August 23, 2018</small></p><p>Challenge: Implement a Slack app that flips tables and deploy it to AWS Lambda and NPM.</p><p>The following links are apart of this:</p><ul><li><a href="https://github.com/ntuanb/slack-fliptable">https://github.com/ntuanb/slack-fliptable</a></li><li><a href="https://www.npmjs.com/package/slack-fliptable">https://www.npmjs.com/package/slack-fliptable</a></li><li><a href="https://travis-ci.org/ntuanb/slack-fliptable">https://travis-ci.org/ntuanb/slack-fliptable</a></li></ul><p>The magic in this is mostly done through the script file ran in Travis when the tests pass 100%:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#/usr/bin/env sh</span>

<span class="nb">echo</span> <span class="s2">"Pushing to Lambda"</span><span class="p">;</span>
dpl <span class="nt">--provider</span><span class="o">=</span><span class="s2">"lambda"</span> <span class="se">\</span>
    <span class="nt">--access_key_id</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">AWS_ACCESS_KEY</span><span class="k">}</span><span class="s2">"</span> <span class="se">\</span>
    <span class="nt">--secret_access_key</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">AWS_SECRET_KEY</span><span class="k">}</span><span class="s2">"</span> <span class="se">\</span>
    <span class="nt">--function_name</span><span class="o">=</span><span class="s2">"slack-fliptable"</span> <span class="se">\</span>
    <span class="nt">--role</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">AWS_LAMBDA_ROLE</span><span class="k">}</span><span class="s2">"</span> <span class="se">\</span>
    <span class="nt">--runtime</span><span class="o">=</span><span class="s2">"nodejs8.10"</span> <span class="se">\</span>
    <span class="nt">--region</span><span class="o">=</span><span class="s2">"ap-southeast-2"</span> <span class="se">\</span>
    <span class="nt">--handler_name</span><span class="o">=</span><span class="s2">"handler"</span><span class="p">;</span>

<span class="nb">echo</span> <span class="s2">"Pushing to NPM"</span>
<span class="nb">echo</span> <span class="s2">"//registry.npmjs.org/:_password=</span><span class="k">${</span><span class="nv">NPM_PASSWORD</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;</span> ~/.npmrc
<span class="nb">echo</span> <span class="s2">"//registry.npmjs.org/:_authToken=</span><span class="k">${</span><span class="nv">NPM_TOKEN</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> ~/.npmrc
<span class="nb">echo</span> <span class="s2">"//registry.npmjs.org/:username=</span><span class="k">${</span><span class="nv">NPM_USERNAME</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> ~/.npmrc
<span class="nb">echo</span> <span class="s2">"//registry.npmjs.org/:email=</span><span class="k">${</span><span class="nv">NPM_EMAIL</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> ~/.npmrc
npm publish ./ <span class="o">||</span> <span class="nb">true</span></code></pre></figure><p>An app is added in slack where a slack <code class="highlighter-rouge">command</code> is added with response url pointing to the <code class="highlighter-rouge">API Gateway</code> provided by Lambda.</p><p>The resulting output is:</p><p><img src="https://blog.tuanb.me/images/2018/slack-flip-table.png" alt="Slack table flipping" /></p><hr class="divider"><div id="disqus_thread"></div><script defer> (function() { var d = document, s = d.createElement('script'); s.src = '//tuanb-me.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })();</script><noscript>Please enable JavaScript to view the comments</noscript> </article></main><footer><div class="links"> <a href="/contact/">Contact</a> <a class="theme" onclick="theme()">Dark/Light</a></div></footer><script src="https://cdn.jsdelivr.net/npm/ga-lite@1/dist/ga-lite.min.js" async></script><script> var galite = galite || {}; galite.UA = 'UA-90397102-1';</script></body></html>
